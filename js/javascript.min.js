function reCalcFields(t){$("#"+t+" tr").each(function(e,i){var a=e-1;$(this).find("#"+t+"-show").attr("name",t+"-show["+a+"]"),$(this).find("#"+t+"-required").attr("name",t+"-required["+a+"]"),$(this).find(".removeField").attr("id","remove-"+e)})}$(document).ready(function(){var t={0:"views",1:"view",2:"categories",3:"category"};function e(){var t=15;e=setInterval(function(){$("p#countdowntime span").html(t),0==t?($("p#countdowntime").fadeOut(),$("#download-full-package").hide().delay(1e3).fadeIn(1e3),$("#step3").slideDown()):3==t?($("#step2").slideDown(),$("p#countdowntime span").removeClass("badge-info"),$("p#countdowntime span").addClass("badge-success")):8==t&&($("#step1").slideDown(),$("p#countdowntime span").removeClass("badge-inverse"),$("p#countdowntime span").addClass("badge-info")),t--},1e3)}$(".tab-content").click(function(){$(".span12").trigger("focusout")}),$("#myTab").click(function(){$(".span12").trigger("focusout")}),$("#jversionselect button").click(function(){$("#jversionselect button").removeClass(),$("#jversionselect button").addClass("btn"),$value=$(this).val().split(".").join(""),"250"==$value&&($value="25"),$value="label-j"+$value,$(this).addClass("btn-warning active "+$value),$("#jversion").val($(this).val())}),$("#usedatabasegroup button").click(function(){$("#usedatabasegroup button").removeClass("btn-warning active"),$(this).addClass("btn-warning active"),$("#usedatabase").val($(this).val()),$(".span12").trigger("focusout")}),$("#needhelp").click(function(){var t=$("#showhelpfortables").css("display"),e=$("#needhelptext").html(),i=$("#needhelptext-return").html(),a="block"==t?e:i;$("#showhelpfortables").slideToggle("slow"),$(this).html(a)}),$("#showVideo").click(function(){var t="block"==$("#membershipVideo").css("display")?'<i class="icon-film"></i> Show Video':'<i class="icon-remove"></i> Hide Video';$("#membershipVideo").slideToggle("slow"),$(this).html(t)}),$("#addView").click(function(){var t=$(".view").length,e="";e+='<div id="viewwrap-'+t+'" class="control-group">',e+='\t\t<label class="control-label">View</label>',e+='\t\t<div class="controls">',e+='\t\t\t<input type="text" class="view input required" name="view[]" value="" />',e+='\t\t\t<div class="status"></div>',e+="\t\t\t<label>Single View Verbiage</label>",e+='\t\t\t<input type="text" name="view-single[]" id="mainview-single" value="" class="input required" />',e+='\t\t\t<div class="status"></div>',e+='\t\t\t<div id="removeview-'+t+'" class="btn btn-small btn-danger removeView" style="margin-left: 4px;"><i class="icon icon-remove icon-white"></i></div>',e+="\t\t</div>\x3c!-- /.controls --\x3e",e+="</div>\x3c!-- /.control-group --\x3e",$("#addviewparent").before(e);var i="";i+='<div class="accordion-group">',i+='\t<div class="accordion-heading">',i+='\t\t<a id="view-'+t+'-header" class="accordion-toggle" data-toggle="collapse" data-parent="#accordion" href="#view'+t+'">view-'+t+"-table</a>",i+='\t\t<input type="hidden" name="view-'+t+'-table" id="view-'+t+'-table" value="" />',i+="\t</div>\x3c!-- /.accordion-heading --\x3e",i+='\t<div id="view'+t+'" class="accordion-body collapse">',i+='\t\t<div class="accordion-inner">',i+='\t\t\t<table id="view-'+t+'" class="table table-bordered table-hover sortable">',i+="\t\t\t\t<tr><td>#</td><td>Field Name & Type</td><td>Default/Values</td><td></td></tr>",i+="\t\t\t\t<tr>",i+="\t\t\t\t\t<td>1</td>",i+="\t\t\t\t\t<td>",i+='\t\t\t\t\t\t<div style="margin: 0 0 5px 0;">',i+='\t\t\t\t\t\t\t<input type="text" name="view-'+t+'-field[]" id="view-'+t+'-field" class="input required input-block-level" placeholder="" />',i+="\t\t\t\t\t\t</div>",i+='\t\t\t\t\t\t<select name="view-'+t+'-fieldtype[]" id="view-'+t+'-fieldtype" class="input input-block-level">',i+='\t\t\t\t\t\t\t<optgroup label="Standard Fields">',i+='\t\t\t\t\t\t\t\t<option value="calendar">Calendar</option>',i+='\t\t\t\t\t\t\t\t<option value="category">Category</option>',i+='\t\t\t\t\t\t\t\t<option value="checkbox">Checkbox</option>',i+='\t\t\t\t\t\t\t\t<option value="editor">Content Editor</option>',i+='\t\t\t\t\t\t\t\t<option value="file">Image Upload</option>',i+='\t\t\t\t\t\t\t\t<option value="hidden">Hidden</option>',i+='\t\t\t\t\t\t\t\t<option value="numbers">Numbers</option>',i+='\t\t\t\t\t\t\t\t<option value="integer">Integer</option>',i+='\t\t\t\t\t\t\t\t<option value="list">List (select drop down)</option>',i+='\t\t\t\t\t\t\t\t<option value="radio">Radio</option>',i+='\t\t\t\t\t\t\t\t<option value="text" selected>Text Box</option>',i+='\t\t\t\t\t\t\t\t<option value="textarea">Text Area</option>',i+="\t\t\t\t\t\t\t</optgroup>",i+="\t\t\t\t\t\t</select>",i+="\t\t\t\t\t</td>",i+='\t\t\t\t\t<td><textarea rows="2" name="view-'+t+'-default[]" id="view-'+t+'-default" class="input-block-level"></textarea></td>',i+="\t\t\t\t\t<td>",i+='\t\t\t\t\t\t<label class="checkbox">',i+='\t\t\t\t\t\t\t<input type="checkbox" name="view-'+t+'-show[0]" id="view-'+t+'-show" value="1"> Show on Manager View',i+="\t\t\t\t\t\t</label>",i+='\t\t\t\t\t\t<label class="checkbox">',i+='\t\t\t\t\t\t\t<input type="checkbox" name="view-'+t+'-required[0]" id="view-'+t+'-required" value="1"> Required',i+="\t\t\t\t\t\t</label>",i+="\t\t\t\t\t</td>",i+="\t\t\t\t\t<td>",i+='\t\t\t\t\t\t<div class="btn btn-small moveField"><i class="icon icon-move"></i></div>',i+='\t\t\t\t\t\t<div id="remove-1" class="btn btn-small btn-danger removeField"><i class="icon icon-remove icon-white"></i></div>',i+="\t\t\t\t\t</td>",i+="\t\t\t\t</tr>",i+="\t\t\t</table>",i+='\t\t\t<div rel="view-'+t+'" class="control-group">',i+='\t\t\t\t<div class="pull-right"><div class="btn btn-warning addField"><i class="icon-plus-sign icon-white"></i> Add Field</div></div>',i+='\t\t\t\t<div class="clearfix"></div>',i+="\t\t\t</div>\x3c!-- /.control-group --\x3e",i+="\t\t</div>\x3c!-- /.accordion-inner --\x3e",i+="\t</div>\x3c!-- /#view"+t+" --\x3e",i+="</div>\x3c!-- /.accordion-group --\x3e",$("#accordionAdd").before(i);var a="";a+='<div class="control-group">',a+='\t\t<label class="control-label" id="view-'+t+'-image-label">Image</label>',a+='\t\t<div class="controls">',a+='\t\t\t<input class="imageTab" type="file" name="images[]" />',a+='\t\t\t<input type="hidden" id="imagesName'+t+'" name="imagesname[]" value="" />',a+="\t\t</div>\x3c!-- /.controls --\x3e",a+="</div>\x3c!-- /.control-group --\x3e",$("#imageAdd").before(a),$(".span12").focusout(),reSortable()}),$("#views").on("click",".removeView",function(){var t=$(this).attr("id").split("-");$(this).parent().parent(".control-group").attr("id");$("#viewwrap-"+t[1]).remove(),$("#view"+t[1]).parent().remove(),$(".span12").focusout()}),$(document).click(function(){$(".view").each(function(t,e){var i=t,a=$.trim($(this).val()),o="view-"+i+"-header",n="imagesName"+i,l="view-"+i+"-image-label";$("#"+("view-"+i)).val(a),$("#"+n).val(a),a||(a="View "+i),$("#"+o).html(a),$("#"+l).html(a+" Image")})}),$("#tables").on("click",".addField",function(){var t=$(this).parent().parent().attr("rel"),e=$("#"+t+" tr").length,i=e-1;reCalcFields(t);var a="";a+="<tr>",a+="\t<td>"+e+"</td>",a+="\t<td>",a+='\t\t<div style="margin: 0 0 5px 0;">',a+='\t\t\t<input type="text" name="'+t+'-field[]" id="'+t+'-field" class="input required input-block-level" placeholder="" />',a+="\t\t</div>",a+='\t\t<select name="'+t+'-fieldtype[]" id="'+t+'-fieldtype" class="input input-block-level">',a+='\t\t\t<optgroup label="Standard Fields">',a+='\t\t\t\t<option value="calendar">Calendar</option>',a+='\t\t\t\t<option value="category">Category</option>',a+='\t\t\t\t<option value="checkbox">Checkbox</option>',a+='\t\t\t\t<option value="editor">Content Editor</option>',a+='\t\t\t\t<option value="file">File/Image Upload</option>',a+='\t\t\t\t<option value="hidden">Hidden</option>',a+='\t\t\t\t<option value="numbers">Numbers</option>',a+='\t\t\t\t<option value="integer">Integer</option>',a+='\t\t\t\t<option value="list">List (select drop down)</option>',a+='\t\t\t\t<option value="radio">Radio</option>',a+='\t\t\t\t<option value="text" selected>Text Box</option>',a+='\t\t\t\t<option value="textarea">Text Area</option>',a+="\t\t\t</optgroup>",a+="\t\t</select>",a+="\t</td>",a+="\t<td>",a+='\t\t<textarea rows="2" name="'+t+'-default[]" id="'+t+'-default" class="input-block-level"></textarea>',a+="\t</td>",a+="\t<td>",a+='\t\t<label class="checkbox"><input type="checkbox" name="'+t+"-show["+i+']" id="'+t+'-show" value="1"> Show on Manager View</label>',a+='\t\t<label class="checkbox"><input type="checkbox" name="'+t+"-required["+i+']" id="'+t+'-required" value="1"> Required</label>',a+="\t</td>",a+="\t<td>",a+='\t\t<div class="btn btn-small moveField"><i class="icon icon-move"></i></div>',a+='\t\t<div id="remove-'+e+'" class="btn btn-small btn-danger removeField"><i class="icon icon-remove icon-white"></i></div>',a+="\t</td>",a+="</tr>",$("#"+t+" tr:nth-child("+e+")").after(a),$(".span12").focusout(),reSortable()}),$("#tables").on("click",".removeField",function(){var t=$(this).attr("id").split("-"),e=$(this).parents("table").attr("id"),i=parseInt(t[1])+1;$("#"+e+" tr:nth-child("+i+")").fadeOut("1000").delay(2e3).remove();$("#"+e+" tr").length;reCalcFields(e),$("#"+e+" tr").each(function(t){if (t>0){var i=t+1;$("#"+e+" tr:nth-child("+i+") td:nth-child(1)").html(t),$("#"+e+" tr:nth-child("+i+") td:nth-child(7)").html('<div id="remove-'+t+'" class="btn btn-small btn-danger removeField"><i class="icon icon-remove icon-white"></i></div>')}}),$(".span12").focusout()}),$("#filename").keyup(function(){var t=$(this).val();$("#mainview").val(t),$("#mainviewtable").val(t),$("#imagesName0").val(t),t||(t="Main View"),$("#mainview-header").html(t),$("#mainview-image-label").html(t+" Image")}).keyup(),$("#myTab a").click(function(t){t.preventDefault(),$(this).tab("show")}),$(".pophelp").popover(),$(".toolhelp").tooltip(),$("#login").on("shown",function(){$("#modal-email").focus()}),$(".span12").focusout(function(){var e=empty_count1=empty_count2=empty_count3=0,i=display1=display2=display3="",a=$(".required").size();$("#install .required").each(function(t){var i=$.trim($(this).attr("id")),a=$.trim($(this).val());""==a?($(this).next().html('<img src="images/bad.png" />'),e++):"version"==i&&!function(t){var e=t.match(/^\d{1,2}\.\d{1,2}\.\d{1,2}$/);null==e&&null==(e=t.match(/^\d{1,2}\.\d{1,2}$/))&&(e=t.match(/^\d+$/));return e}(a)?($(this).next().html('<img src="images/bad.png" />'),e++):$(this).next().html('<img src="images/good.png" />')}),$("#authorinfo .required").each(function(t){var e=$.trim($(this).attr("id")),i=$.trim($(this).val());""==i?($(this).next().html('<img src="images/bad.png" />'),empty_count1++):"authoremail"==e?/^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(i)?$(this).next().html('<img src="images/good.png" />'):($(this).next().html('<img src="images/bad.png" />'),empty_count1++):"authorurl"==e?/^(?:(ftp|http|https):\/\/)?(?:[\w-]+\.)+[a-z]{2,6}$/.test(i)?$(this).next().html('<img src="images/good.png" />'):($(this).next().html('<img src="images/bad.png" />'),empty_count1++):$(this).next().html('<img src="images/good.png" />')}),$("#views .required").each(function(e){var i=$("#usedatabase").val(),a=$.trim($(this).val());if (1==i)if (""==a)$(this).next().html('<img src="images/bad.png" />'),$(this).addClass("error"),empty_count2++;else{var o=!0;if ($.each(t,function(t,e){e.toLowerCase()==a.toLowerCase()&&(o=!1)}),o)$(this).next().html('<img src="images/good.png" />'),$(this).removeClass("error"),$("#viewsMsg").html("");else{var n='<div class="alert alert-error">"'+a+'" can not be used as a view name!</div>';$("#viewsMsg").html(n)}}else $(this).next().html('<img src="images/good.png" />'),$(this).removeClass("error")}),$("#tables .required").each(function(t){var e=$("#usedatabase").val(),i=$.trim($(this).val());1==e&&""==i?($(this).addClass("error"),empty_count3++):$(this).removeClass("error")}),i=0==e?'<span class="badge badge-success">0</span>':'<span class="badge badge-important">'+e+"</span>",0==empty_count1?display1='<span class="badge badge-success">0</span>':display1='<span class="badge badge-important">'+empty_count1+"</span>",0==empty_count2?display2='<span class="badge badge-success">0</span>':display2='<span class="badge badge-important">'+empty_count2+"</span>",0==empty_count3?display3='<span class="badge badge-success">0</span>':display3='<span class="badge badge-important">'+empty_count3+"</span>",$("#myTab li:nth-child(1) span").html(i),$("#myTab li:nth-child(2) span").html(display1),$("#myTab li:nth-child(3) span").html(display2),$("#myTab li:nth-child(4) span").html(display3);var o=e+empty_count1+empty_count2+empty_count3,n=100-Math.round(o/a*100);n+="%",$(".bar").css("width",n)}),e(),$("#download-full-package").hide(),$("#step1").hide(),$("#step2").hide(),$("#step3").hide(),$("form#mainform").submit(function(){var t=100*parseFloat($(".bar").css("width"))/parseFloat($(".bar").parent().css("width"));t=Math.round(t);return""==$("#componentname").val()&&!1,""==$("#filename").val()&&!1,""==$("#version").val()&&!1,""==$("#description").val()&&!1,""==$("#copyright").val()&&!1,""==$("#license").val()&&!1,""==$("#author").val()&&!1,""==$("#authoremail").val()&&!1,""==$("#authorurl").val()&&!1,!0});var i=$(".imageBar"),a=$(".imagePercent"),o=$("#imageReturn");$("#imagesForm").ajaxForm({beforeSend:function(){o.empty();i.width("0%"),a.html("0%")},uploadProgress:function(t,e,o,n){var l=n+"%";i.width(l),a.html(l)},complete:function(t){o.html(t.responseText),console.log(t.responseText);var e=$(t.responseText).filter("#addToHiddenImages").html();$("#addHiddenImages").html(e)}})});
